extends ../../layouts/default.pug 
include ../../mixins/filter-status.pug
include ../../mixins/search.pug
include ../../mixins/form-change-multi.pug
include ../../mixins/alert.pug 
include ../../mixins/table-tree.pug 
include ../../mixins/moment.pug 

block main 
    if(records.length > 0)
        +alert-success(5000)
        h1 Thùng rác danh mục sản phẩm 
        //- .card.mb-3 
        //-     .card-header Bộ lọc và tìm kiếm 
        //-     .card-body 
        //-         .row 
        //-             .col-6 
        //-                 +filter-status(filterStatus)
        //-             .col6 
        //-                 +search(keyword)

        .card.mb-3 
            .card-header Danh sách
                .card-body 
                    .row
                        .col-8
                            +form-change-multi(`${prefixAdmin}/products-category/change-multi?_method=PATCH`)
                        .col-4 

                    table(
                        class="table table-hover table-sm"
                        checkbox-multi
                    ) 
                        thead 
                            tr 
                                th 
                                    input(type="checkbox" name= "checkall")
                                th STT 
                                th Hình ảnh 
                                th Tiêu đề
                                th Giá
                                th Vị trí
                                th Trạng thái 
                                th Người tạo
                                th Hành động
                        tbody
                            each item, index in records
                                tr 
                                    td 
                                        input(
                                            type="checkbox"
                                            name="id"
                                            value=item.id
                                        )
                                    td #{index+1}
                                    td 
                                        img(
                                            src= item.thumbnail
                                            alt = item.title
                                            width="100px"
                                            height="auto"
                                        )
                                    td #{item.title}
                                    td #{item.price}$
                                    td 
                                        input(
                                            type="number"
                                            value=item.position
                                            style= "width: 60px"
                                            min="1"
                                            name="position"
                                            )
                                    td
                                        if(item.status == "active")
                                            a(
                                                class="badge badge-success"
                                                ) Hoạt động
                                        else 
                                            a(
                                                class="badge badge-danger"
                                                ) Dừng hoạt động
                                        
                                    td 
                                        p #{item.accountFullName}    
                                        p 
                                            +formatDateTime(item.deletedBy.deletedAt)   
                                    td 
                                        form(
                                            action=`${prefixAdmin}/bins/product/restore/${item.id}?_method=PATCH`
                                            method="POST"
                                            style="display: inline;"
                                        ) 
                                            button(
                                                type='submit'
                                                class="btn btn-secondary btn-sm"
                                            ) Khôi phục
                                        form(
                                            action=`${prefixAdmin}/bins/product/delete/${item.id}?_method=DELETE`
                                            method="POST"
                                            style="display: inline;"
                                        )
                                            button(
                                                class="btn btn-danger btn-sm ml-1"
                                                data-id=item.id
                                                button-delete
                                                type = 'submit'
                                                onclick="return confirmDelete()"
                                            ) Xóa vĩnh viễn



        form(
            action=""
            method="POST"
            id="form-change-status"
            data-path=`${prefixAdmin}/products-category/change-status`
        ) 
        form(
            action=""
            method="POST"
            id="form-delete-item"
            data-path=`${prefixAdmin}/products-category/delete`
        ) 

        

        script(src="/admin/js/product.js")
    else
        h1 Chưa có danh mục nào bị xóa